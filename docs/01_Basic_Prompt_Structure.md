# 第1章: 基本的なプロンプトの構造

このドキュメントは `Anthropic 1P/01_Basic_Prompt_Structure.ipynb` の主要な概念を日本語で説明するものです。

## セットアップ

（このセクションは、元のノートブックのセットアップセルに関連しますが、ここでは主にAPIの概念に焦点を当てます。）

## レッスン

Anthropicは2つのAPIを提供しています：従来のText Completions APIと現在のMessages APIです。このチュートリアルでは、Messages APIのみを使用します。

Messages APIを使用してClaudeを呼び出すには、最低限次のパラメータが必要です：

- `model`: 呼び出すモデルのAPIモデル名。
- `max_tokens`: 停止する前に生成するトークンの最大数。Claudeがこの最大値に達する前に停止する可能性があることに注意してください。このパラメータは生成するトークンの絶対最大数を指定するだけであり、ハードストップです（つまり、Claudeが単語の途中や文の途中で生成を停止する可能性があります）。
- `messages`: 入力メッセージの配列。モデルは、ユーザーとアシスタントの交互の会話ターンで動作するように訓練されています。新しいメッセージを作成する際、`messages`パラメータで以前の会話ターンを指定し、モデルが会話の次のメッセージを生成します。
    - 各入力メッセージは、`role`と`content`を持つオブジェクトでなければなりません。単一の`user`ロールメッセージを指定することも、複数の`user`および`assistant`メッセージを含めることもできます（その場合は交互にする必要があります）。最初のメッセージは常に`user`ロールを使用する必要があります。

オプションのパラメータもあります：

- `system`: システムプロンプト - これについては以下で詳しく説明します。
- `temperature`: Claudeの応答の変動度。これらのレッスンと演習では、`temperature`を0に設定しています。

すべてのAPIパラメータの完全なリストについては、[APIドキュメント](https://docs.anthropic.com/claude/reference/messages_post)をご覧ください。

### 例

Claudeが正しくフォーマットされたプロンプトにどのように応答するかを見てみましょう。

（元のノートブックのコード例は省略し、概念を説明します。）

例1：
```
User: こんにちはクロード、調子はどうですか？
```

例2：
```
User: 海の色を教えてくれますか？
```

次に、正しいMessages APIフォーマットを含まないプロンプトの例を見てみましょう。これらの誤ったフォーマットのプロンプトに対して、Messages APIはエラーを返します。

エラー例1：`messages`配列に`role`と`content`フィールドがない。
エラー例2：`user`と`assistant`のロールが交互になっていない。

**重要なルール：**
- `user`と`assistant`メッセージは**必ず交互に**しなければなりません。
- メッセージは**必ず`user`ターンから始める**必要があります。
- プロンプトには複数の`user`と`assistant`のペアを含めることができます（複数ターンの会話をシミュレートするように）。

### システムプロンプト

**システムプロンプト**を使用することもできます。システムプロンプトは、「ユーザー」ターンで質問やタスクを提示する前に、**Claudeにコンテキスト、指示、ガイドラインを提供する**方法です。

構造的には、システムプロンプトは`user`と`assistant`メッセージのリストとは別に存在し、したがって別の`system`パラメータに属します。

システムプロンプトを使用する理由は何でしょうか？ **よく書かれたシステムプロンプトは、ルールや指示に従う能力を高めるなど、さまざまな方法でClaudeのパフォーマンスを向上させる**ことができます。詳細については、Claudeで[システムプロンプトを使用する方法](https://docs.anthropic.com/claude/docs/how-to-use-system-prompts)に関するドキュメントをご覧ください。

#### システムプロンプトの例

```
System: あなたの答えは、常に会話を深めるための一連の批判的思考を促す質問でなければなりません（質問に対する答えを提供しないでください）。ユーザーの質問には実際には答えないでください。

User: なぜ空は青いの？
```

上記は、Claudeに直接的な答えではなく、さらなる思考を促す質問を生成させるシステムプロンプトの例です。

## 演習

（このセクションは元のノートブックの演習に関連しますが、ここでは省略します。）

## まとめ

この章では、Anthropic Messages APIの基本的な構造、必須およびオプションのパラメータ、メッセージの正しいフォーマット、そしてシステムプロンプトの役割と利点について学びました。これらの基本を理解することが、効果的なプロンプトエンジニアリングの第一歩です。
