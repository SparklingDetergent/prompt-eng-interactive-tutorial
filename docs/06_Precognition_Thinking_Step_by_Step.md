# 第6章: 予知（ステップバイステップ思考）

このドキュメントは `Anthropic 1P/06_Precognition_Thinking_Step_by_Step.ipynb` の主要な概念を日本語で説明するものです。

## レッスン

もし誰かに叩き起こされ、すぐにいくつかの複雑な質問に答えなければならないとしたら、どうでしょうか？おそらく、**最初に答えをじっくり考える**時間を与えられた場合ほど上手くはいかないでしょう。

実は、Claudeも同じです。

**Claudeにステップバイステップで考える時間を与えることで、特に複雑なタスクにおいて、Claudeの回答がより正確になることがあります。** しかし、**思考は声に出して（書き出して）初めて意味を持ちます。** Claudeに考えてから答えだけを出力するように頼むことはできません。この場合、実際には思考は行われていません。思考プロセス自体がClaudeの出力の一部である必要があります。

### 例

**例1: 映画レビューの感情分析**

以下のプロンプトでは、人間には2番目の文が最初の文の含意を裏切っていることが明らかです。しかし、**Claudeは「無関係なニュースでは」という言葉を文字通りに受け取りすぎてしまいます。**

初期プロンプト：
```
この映画レビューの感情はポジティブですか、ネガティブですか？

この映画はその新鮮さと独創性で私を驚かせた。まったく無関係なニュースだが、私は1900年から岩の下で暮らしている。
```
Claudeの応答：（文脈を誤解し、ポジティブと判断する可能性が高い）

この応答を改善するために、**Claudeに回答する前にまずじっくり考えさせましょう。** そのために、Claudeがタスクを処理し、考え抜くために取るべきステップを文字通りに記述します。少々のロールプロンプティングと組み合わせることで、Claudeはレビューをより深く理解することができます。

改善されたプロンプト：
```
System: あなたは映画レビューを読むのが得意な読者です。
User: このレビューの感情はポジティブですか、ネガティブですか？ まず、それぞれの側の最良の議論を<positive-argument>と<negative-argument>のXMLタグに書き出し、その後で答えてください。

この映画はその新鮮さと独創性で私を驚かせた。まったく無関係なニュースだが、私は1900年から岩の下で暮らしている。
```
Claudeの応答（期待される形式）：
```
<positive-argument>映画は新鮮さと独創性でレビュアーを驚かせたと述べています。</positive-argument>
<negative-argument>レビュアーが1900年から岩の下で暮らしているという事実は、現代の映画に対する彼らの視点が歪んでいる可能性を示唆しており、その称賛は信頼できないかもしれません。</negative-argument>
このレビューの感情はネガティブです。
```
このステップバイステップの思考プロセスにより、Claudeはより微妙なニュアンスを捉え、より正確な結論に至ることができます。

**順序への感受性：**
Claudeは時々、指示の順序に敏感です。上記の例で、`<negative-argument>` を先に、`<positive-argument>` を後に書くように指示すると、Claudeの最終的な評価が変わることがあります。多くの場合（常にではありませんが）、Claudeは2つの選択肢のうち2番目のものを選ぶ傾向があります。これは、訓練データであるウェブ上の情報で、2番目の選択肢が正しいことが多かったためかもしれません。

**例2: 事実に基づく質問（俳優の生年と出演映画）**

Claudeにステップバイステップで考えさせることが、誤った回答を正しい回答に変えることができます。

初期プロンプト：
```
1956年生まれの俳優が出演している有名な映画の名前を挙げてください。
```
Claudeの応答：（トム・ハンクス主演の「フォレスト・ガンプ」など、誤った情報を返す可能性がある。トム・ハンクスは1956年生まれだが、映画の公開年や他の俳優との混同が起こりうる。）

改善されたプロンプト（ステップバイステップ思考を導入）：
```
1956年生まれの俳優が出演している有名な映画の名前を挙げてください。まず、<brainstorm>タグの中にいくつかの俳優とその生年についてブレインストーミングし、その後であなたの答えを述べてください。
```
Claudeの応答（期待される形式）：
```
<brainstorm>
- トム・ハンクスは1956年生まれです。
- メル・ギブソンは1956年生まれです。
- デヴィッド・カッパーフィールドは1956年生まれです。
</brainstorm>
トム・ハンクスが出演した有名な映画には「フォレスト・ガンプ」があります。メル・ギブソンが出演した有名な映画には「ブレイブハート」があります。
```
このように、まず関連情報をリストアップ（ブレインストーミング）させることで、Claudeはより正確な最終回答を導き出しやすくなります。

## 重要なポイント

- **思考を「書き出す」よう指示する:** Claudeに内部で「考える」だけでなく、その思考プロセス（理由、中間ステップ、分析など）を明示的に書き出すよう求めます。
- **XMLタグで構造化:** `<scratchpad>`、`<thinking_process>`、`<analysis>` のようなXMLタグを使用して、思考部分と最終的な回答部分を区別させると効果的です。
- **複雑なタスクに有効:** 多段階の推論、微妙なニュアンスの理解、または複数の情報を組み合わせて回答する必要がある場合に特に役立ちます。
- **間違いを減らす:** Claudeが早まった結論に達したり、重要な詳細を見落としたりするのを防ぐのに役立ちます。

## まとめ

この章では、「ステップバイステップ思考」（または「予知」）というテクニックを学びました。Claudeに複雑な問題に取り組ませる際に、まず思考のプロセスを（XMLタグなどを使って）明示的に書き出させ、その後に最終的な結論を述べさせることで、回答の質と正確性を向上させることができます。これは、Claudeが性急な判断を避け、より慎重に情報を処理するための時間を与える効果があります。
